<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDP GUI</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://mpld3.github.io/_static/js/mpld3.v0.5.1.js"></script>
    <!-- Include Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <style>
        body {
            background-color: #f8f8f8;
            color: #333;
        }       
        a {
            color: #007bff;
        }
        .custom-bg-color {
            background-color: #005BAD; 
        }
        /* Adjust color scheme as needed */
        .container {
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        /* Apply box shadows and borders to elements as needed */
        button {
            background-color: #005BAD;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #007bff;
        }
        /* CSS code for the table */
        #clusterSchedule {
            font-family: Arial, sans-serif;
            border-collapse: collapse;
            width: 1000px; /* Set width in pixels */
            height: 800px; /* Set height in pixels */
            overflow: auto;
            margin: 0 auto;   /* Center the table horizontally */
        }
    
        #clusterSchedule th, #clusterSchedule td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
    
        #clusterSchedule th {
            background-color: #f2f2f2;
        }
    
        #clusterSchedule tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    
        #clusterSchedule tr:hover {
            background-color: #ddd;
        }
        .indented {
        margin-left: 20px; /* Adjust the margin as needed */
        }
    </style>
</head>
<body>
    <!-- Top bar -->
    <nav class="navbar navbar-dark custom-bg-color">
        <img src="{{ url_for('static', filename='Lockheed_Martin_logo.svg') }}" width="300" class="img-fluid" alt="logo">
    </nav>    
    
    <!-- Main content area -->
    <div class="container mt-4">
        <!-- Nav tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="algorithm-tab" data-toggle="tab" href="#algorithm1" role="tab" aria-controls="algorithm1" aria-selected="false">Algorithm Analysis</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="graph-tab" data-toggle="tab" href="#cluster1" role="tab" aria-controls="cluster1" aria-selected="false">Cluster Plot</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="about-tab" data-toggle="tab" href="#about1" role="tab" aria-controls="about1" aria-selected="false">About</a>
            </li>
        </ul>

        <!-- Tab panes -->
    <div class="tab-content" id="myTabContent">
        <!-- Home tab content -->
        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
            <h2>Home</h2>
            <p class="lead"><strong>Lockheed Martin SDP Homepage</strong></p>
            <div class="row">
                <div class="col-md-12">
                    <p>This project is a collaborative effort between <strong>University of Connecticut (UConn) students</strong> and <strong>Lockheed Martin</strong>, aimed at harnessing the power of data science and machine learning to drive innovation in server management and operational efficiency.</p>
                </div>
            </div>
            <p class="lead"><strong>Description of Problem</strong></p>
            <div class="row">
                <div class="col-md-12">
                    <p>Team 16 was tasked with finding an atypical approach for powering off compute resources when not in use in order to save Lockheed Martin millions of dollars or more. The challenge here is the ability to accurately predict, in a repeatable fashion, when a compute resource is not being used, turning it off and eliminating the need to pay for it.</p>
                    <p>Therefore, we will need to use machine learning models and algorithms to find the optimal compute running time at an efficient cost for each unique workload. The goal is to not impede productivity while at the same time ensuring resources are not going unused.</p>
                </div>
            </div>
            <p class="lead"><strong>Solutions</strong></p>
            <div class="row">
                <div class="col-md-12">
                    <div class="models_sol">
                        <p>Machine Learning Models:</p>
                        <p class="indented">Seasonal Decomposition Model: *description*</p>
                        <p class="indented">Long Short-Term Memory (LSTM) Model: *description*</p>
                        <p class="indented">Prophet Model: *description*</p>
                    </div>
                    <div class="cluster_sol">
                        <p>Clustering Algorithm:</p>
                        <p class="indented">DBScan:*description*</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Algorithm tab content -->
        <div class="tab-pane fade" id="algorithm1" role="tabpanel" aria-labelledby="algorithm-tab">
            <h2>Algorithm Analysis</h2>
            <!-- Include content for algorithm analysis here -->
            <!-- This could include forms, buttons, and other elements -->
            <!-- Choose an algorithm -->
            <div id="algorithmSelection">
                <p>*Note: Algorithms may take a minute or so to run.*</p>
                <form id="algorithmForm">
                    <label for="algorithm">Choose an algorithm:</label>
                    <select name="algorithm" id="algorithm">
                        <option value="SeasonalDecompositionModel">Seasonal Decomposition Model</option>
                        <option value="LSTMModel">LSTM Model</option>
                        <option value="ProphetModel">Prophet Model</option>
                    </select>
                    <button type="button" onclick="runAlgorithm()">Run Algorithm</button>
                </form>
            </div>

            <!-- Display algorithm results -->
            <div id="plots">
                <img id="plot_base64_1" src="" alt="">
                <img id="plot_base64_2" src="" alt="">
                <div id="loadingMessage" style="display: none;">Loading...</div> <!-- Loading message -->
            </div>
        </div>
        <!-- Cluster Plot tab content -->
        <div class="tab-pane fade" id="cluster1" role="tabpanel" aria-labelledby="cluster-tab">
            <h2>Cluster Plot</h2>
            <!-- Form to select clustering parameters -->
            <form id="clusterForm">
                <div class="input-row">
                    <label for="day">Day:</label>
                    <select name="day" id="day">
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                    </select>
                
                    <label for="start_time">Start Time:</label>
                    <input type="time" id="start_time" name="start_time" min="00:00" max="23:00" step="3600" value="09:00" onchange="validateTime()">

                    <label for="end_time">End Time:</label>
                    <input type="time" id="end_time" name="end_time" min="00:00" max="23:00" step="3600" value="17:00" onchange="validateTime()">
                </div>
                <script>
                    function validateTime() {
                        var startTime = document.getElementById("start_time").value;
                        var endTime = document.getElementById("end_time").value;
            
                        if (startTime && endTime) {
                            if (startTime >= endTime) {
                                alert("End time must be after the start time.");
                                document.getElementById("end_time").value = ""; // Clear the end time value
                            }
                        }
                    }
                </script>
                <div class="input-row">
                    <label for="data_file">Data File:</label>
                    <select name="data_file" id="data_file">
                        <option value="exportforuconn">exportforuconn</option>
                        <option value="placeholder">placeholder</option>
                    </select>
                    <label for="threshold">Threshold:</label>
                    <input type="text" id="threshold" name="threshold" value="1.5"><br>
                </div>
                <button type="button" onclick="runClustering()">Run Clustering</button>
            </form>

            <!-- Container for the plot -->
            <div id="clusterPlot"></div>
            <!-- Container for the schedule -->

            <h2 id="scheduleHeader" style="display: none;">Schedule</h2>
            <div id="clusterSchedule" ></div>
        </div>
        <!-- About tab content -->
        <div class="tab-pane fade" id="about1" role="tabpanel" aria-labelledby="about-tab">
            <h2>About</h2>
            <p>Our Team:</p>
        </div>
    </div>
    
    </div>
    <script>
        function runClustering() {
            document.getElementById('clusterPlot').innerHTML = '<p>Loading...</p>';
            // Get form data
            const day = document.getElementById('day').value;
            const start_time = document.getElementById('start_time').value;
            const end_time = document.getElementById('end_time').value;
            const data_file = document.getElementById('data_file').value;
            const threshold = document.getElementById('threshold').value;
            // Make a POST request to the server to run clustering
            fetch('/run-cluster-graph', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ day, start_time, end_time, data_file, threshold})
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('clusterPlot').innerHTML = '';
                Plotly.newPlot('clusterPlot', JSON.parse(data.plot_data));
                document.getElementById('scheduleHeader').style.display = 'block';
                document.getElementById('clusterSchedule').innerHTML = data.schedule_html;
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
        function runAlgorithm() {
            document.getElementById('loadingMessage').style.display = 'block';
            // Get the selected algorithm from the dropdown
            const selectedAlgorithm = document.getElementById('algorithm').value;

            if (selectedAlgorithm === 'ProphetModel') {
                fetch('/run-prophet', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({})
                })
                .then(response => response.json()) // Assuming your server returns JSON
                .then(data => {
                    // Update the content of the results div based on the response from the server
                    document.getElementById('plot_base64_1').src = "data:image/png;base64," + data.plot_prophet[0];
                    document.getElementById('plot_base64_2').src = "data:image/png;base64," + data.plot_prophet[1];
                    // Hide loading message
                    document.getElementById('loadingMessage').style.display = 'none';
                })
                .catch(error => console.error('Error:', error));
            }
            if (selectedAlgorithm === 'SeasonalDecompositionModel') {
                fetch('/run-seasonaldecomposition', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({})
                })
                .then(response => response.json()) // Assuming your server returns JSON
                .then(data => {
                    // Update the content of the results div based on the response from the server
                    document.getElementById('plot_base64_1').src = "data:image/png;base64," + data.plot_seasonaldecomposition;
                    document.getElementById('plot_base64_2').src = "";
                    // Hide loading message
                    document.getElementById('loadingMessage').style.display = 'none';
                })
                .catch(error => console.error('Error:', error));
            }
            if (selectedAlgorithm === 'LSTMModel') {
                fetch('/run-lstm', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({})
                })
                .then(response => response.json()) // Assuming your server returns JSON
                .then(data => {
                    // Update the content of the results div based on the response from the server
                    document.getElementById('plot_base64_1').src = "data:image/png;base64," + data.plot_lstm;
                    document.getElementById('plot_base64_2').src = "";
                    // Hide loading message
                    document.getElementById('loadingMessage').style.display = 'none';
                })
                .catch(error => console.error('Error:', error));
            }
        } 
</script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>